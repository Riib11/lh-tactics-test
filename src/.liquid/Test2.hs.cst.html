<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Test2.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##610 : GHC.Types.Module | $k_##611}</span><span class='hs-comment'>{-# LANGUAGE NamedFieldPuns #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# LANGUAGE QuasiQuotes #-}</span>
<span class=hs-linenum> 3: </span><span class='hs-comment'>{-# LANGUAGE TemplateHaskell #-}</span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>{-# LANGUAGE TupleSections #-}</span>
<span class=hs-linenum> 5: </span>
<span class=hs-linenum> 6: </span><span class='hs-comment'>-- {-@ LIQUID "--compile-spec" @-}</span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--reflection"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--ple-local"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Test2</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>12: </span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Proof</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Tactic.Core.Quote</span>
<span class=hs-linenum>15: </span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>17: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>S</span> <span class='hs-conid'>N</span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>S</span> <span class='hs-conid'>N</span>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>add</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>22: </span><span class='hs-definition'>add</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>N</span>
<span class=hs-linenum>23: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##568:Test2.N -&gt; lq_tmp$x##569:Test2.N -&gt; {VV : Test2.N | VV == Test2.add lq_tmp$x##568 lq_tmp$x##569
                                                                  &amp;&amp; VV == (if is$Test2.Z lq_tmp$x##568 then lq_tmp$x##569 else Test2.S (Test2.add (lqdc##$select##Test2.S##1 lq_tmp$x##568) lq_tmp$x##569))}</span><span class='hs-definition'>add</span></a> <span class='hs-conid'>Z</span> <a class=annot href="#"><span class=annottext>Test2.N</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##582 : Test2.N | lq_tmp$x##582 == n##a7CA}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>24: </span><span class='hs-definition'>add</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##607:Test2.N -&gt; {lq_tmp$x##605 : Test2.N | is$Test2.S lq_tmp$x##605
                                                    &amp;&amp; not (is$Test2.Z lq_tmp$x##605)
                                                    &amp;&amp; lq_tmp$x##605 == Test2.S lq_tmp$x##607
                                                    &amp;&amp; lqdc##$select##Test2.S##1 lq_tmp$x##605 == lq_tmp$x##607}</span><span class='hs-conid'>S</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##596 : Test2.N | lq_tmp$x##596 == Test2.add m##a7CB n##a7CA
                           &amp;&amp; lq_tmp$x##596 == (if is$Test2.Z m##a7CB then n##a7CA else Test2.S (Test2.add (lqdc##$select##Test2.S##1 m##a7CB) n##a7CA))}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>add</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##601 : Test2.N | lq_tmp$x##601 == m##a7CB}</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##602 : Test2.N | lq_tmp$x##602 == n##a7CA}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>25: </span>
<span class=hs-linenum>26: </span><span class='hs-definition'>return</span> <span class='hs-conid'>[]</span>
<span class=hs-linenum>27: </span>
<span class=hs-linenum>28: </span><span class='hs-comment'>-- {-@ automatic-instances add_m_Sn @-}</span>
<span class=hs-linenum>29: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>30: </span><span class='hs-comment'>-- add_m_Sn :: m:N -&gt; n:N -&gt; {add m (S n) == S (add m n)}</span>
<span class=hs-linenum>31: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>32: </span><span class='hs-comment'>-- [tactic|</span>
<span class=hs-linenum>33: </span><span class='hs-comment'>-- add_m_Sn :: N -&gt; N -&gt; Proof</span>
<span class=hs-linenum>34: </span><span class='hs-comment'>-- add_m_Sn m n =</span>
<span class=hs-linenum>35: </span><span class='hs-comment'>--   induct m;</span>
<span class=hs-linenum>36: </span><span class='hs-comment'>--   auto [Z, S] 3</span>
<span class=hs-linenum>37: </span><span class='hs-comment'>-- |]</span>
<span class=hs-linenum>38: </span><span class='hs-definition'>add_m_Sn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proof</span>
<span class=hs-linenum>39: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1025:Test2.N -&gt; lq_tmp$x##1026:Test2.N -&gt; ()</span><span class='hs-definition'>add_m_Sn</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>40: </span>
<span class=hs-linenum>41: </span><span class='hs-comment'>-- {-@ automatic-instances add_n_Z @-}</span>
<span class=hs-linenum>42: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>43: </span><span class='hs-comment'>-- add_n_Z :: n:N -&gt; {add n Z == n}</span>
<span class=hs-linenum>44: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>45: </span><span class='hs-comment'>-- [tactic|</span>
<span class=hs-linenum>46: </span><span class='hs-comment'>-- add_n_Z :: N -&gt; Proof </span>
<span class=hs-linenum>47: </span><span class='hs-comment'>-- add_n_Z n =</span>
<span class=hs-linenum>48: </span><span class='hs-comment'>--   induct n;</span>
<span class=hs-linenum>49: </span><span class='hs-comment'>--   auto [Z, S, add] 2</span>
<span class=hs-linenum>50: </span><span class='hs-comment'>-- |]</span>
<span class=hs-linenum>51: </span><span class='hs-definition'>add_n_Z</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proof</span> 
<span class=hs-linenum>52: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1279:Test2.N -&gt; ()</span><span class='hs-definition'>add_n_Z</span></a> <a class=annot href="#"><span class=annottext>Test2.N</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>53: </span>
<span class=hs-linenum>54: </span><span class='hs-comment'>-- return [] -- since add_comm uses add_m_Sn, add_n_Z</span>
<span class=hs-linenum>55: </span>
<span class=hs-linenum>56: </span><span class='hs-comment'>-- {-@ automatic-instances add_comm @-}</span>
<span class=hs-linenum>57: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>58: </span><span class='hs-comment'>-- add_comm :: m:N -&gt; n:N -&gt; {add m n == add n m}</span>
<span class=hs-linenum>59: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>60: </span><span class='hs-comment'>-- [tactic|</span>
<span class=hs-linenum>61: </span><span class='hs-comment'>-- add_comm :: N -&gt; N -&gt; Proof </span>
<span class=hs-linenum>62: </span><span class='hs-comment'>-- add_comm m n =</span>
<span class=hs-linenum>63: </span><span class='hs-comment'>--   induct m;</span>
<span class=hs-linenum>64: </span><span class='hs-comment'>--   auto [Z, S, add, add_n_Z, add_m_Sn] 2</span>
<span class=hs-linenum>65: </span><span class='hs-comment'>-- |]</span>
<span class=hs-linenum>66: </span><span class='hs-definition'>add_comm</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proof</span> 
<span class=hs-linenum>67: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1523:Test2.N -&gt; lq_tmp$x##1524:Test2.N -&gt; ()</span><span class='hs-definition'>add_comm</span></a> <a class=annot href="#"><span class=annottext>Test2.N</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>Test2.N</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
</body>
</html>